<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warping vs Morphing</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="d-flex justify-content-center py-3">
        <ul class="nav nav-pills">
          <li class="nav-item"><a href="#warping" class="nav-link">Warping</a></li>
          <li class="nav-item"><a href="#morphing" class="nav-link">Morphing</a></li>
          <li class="nav-item"><a href="#references" class="nav-link">References</a></li>
        </ul>
      </header>
  
      <cell>
        <h1>Warping vs Morphing</h1>
    </cell>

    <cell class="container mt-4">
        <h2 id="warping">Warping</h2>

        <!-- File upload form -->
        <div class="input-container">
            <label for="imageUpload" class="btn btn-primary">Choose an Image</label>
            <input type="file" id="imageUpload" accept=".jpg, .jpeg, .png" style="display:none;">
        </div>

        <div class="image-container">
            <div class="square">
                <div class="grid-overlay"></div>  <!-- Grid overlay -->
                <img id="preview" src="#" alt="Image Preview" />
            </div>
            <div class="arrows">
                <button id="warpBtn" class="btn btn-success">Warp Image</button>
                <span class="arrow">â‡’</span>
            </div>
            <div class="square" style="background-color: #f8f9fa;">
                <div class="grid-overlay"></div>
            </div>
        </div>        

        <!-- Coordinate list and reset button centered -->
        <div id="coordinateList">
            <h4>Clicked Coordinates:</h4>
            <ul id="coordinates"></ul>
            <button id="resetBtn" style="display: none;" class="btn btn-danger">Reset</button>
        </div>
    </cell>

    <cell>
        <h2 id="morphing">Morphing</h2>
    </cell>

    <cell>
        <h3 id="references">References</h3>
    </cell>
    
    <script>
        document.getElementById('imageUpload').addEventListener('change', function () {
            let file = this.files[0];
            let reader = new FileReader();
        
            reader.onload = function (event) {
                let base64String = event.target.result;
                let previewImage = document.getElementById('preview');
                
                previewImage.src = base64String;
                previewImage.style.display = 'block';
        
                // Clear previous coordinates and points when a new image is uploaded
                document.getElementById('coordinates').innerHTML = '';
                document.querySelectorAll('.click-point').forEach(point => point.remove());  // Remove previous points
                document.getElementById('resetBtn').style.display = 'none';
        
                // Add click event listener on the image to capture pixel coordinates
                previewImage.addEventListener('click', function(e) {
                    let rect = previewImage.getBoundingClientRect();  // Get image position
                    let x = e.clientX - rect.left;  // Calculate x coordinate relative to image
                    let y = e.clientY - rect.top;   // Calculate y coordinate relative to image
        
                    // Add the clicked coordinates to the list
                    let li = document.createElement('li');
                    li.textContent = 'X: ' + Math.round(x) + ', Y: ' + Math.round(y);
                    document.getElementById('coordinates').appendChild(li);
        
                    // Create a point element to mark the clicked position
                    let point = document.createElement('div');
                    point.classList.add('click-point');
                    point.style.left = x + 'px';
                    point.style.top = y + 'px';
                    document.querySelector('.square').appendChild(point); // Add point to the image container
        
                    // Show reset button after first click
                    document.getElementById('resetBtn').style.display = 'block';
                });
            };
        
            reader.readAsDataURL(file);
        });
        
        // Reset button functionality
        document.getElementById('resetBtn').addEventListener('click', function () {
            document.getElementById('coordinates').innerHTML = ''; // Clear the coordinates list
            document.querySelectorAll('.click-point').forEach(point => point.remove());  // Remove all points
            document.getElementById('resetBtn').style.display = 'none'; // Hide the reset button
        });
    </script>
</body>
</html>